<div class="container">
    <div class="ui-language-dock" id="uiLanguageDock" role="group" aria-label="UI language"
        data-i18n="config.uiLanguageAria" data-i18n-attr="aria-label">
        <div class="ui-language-glow" aria-hidden="true"></div>
        <div class="ui-language-flag-row" id="uiLanguageFlags">
            <!-- Flags are rendered dynamically -->
        </div>
    </div>

    <div class="header">
        <div class="logo">
            <img src="logo.png" alt="SubMaker Logo" style="width: 80px; height: 80px; border-radius: 20px;">
        </div>
        <h1 id="heroTitle" data-i18n="config.heroTitle">SubMaker</h1>
        <div class="version-badge-wrapper">
            <p class="subtitle" id="heroSubtitle" data-i18n="config.heroSubtitle">AI-Powered Subtitle Translation</p>
            <span id="version-badge" class="version-badge" style="display:none;"></span>
        </div>
    </div>


    <div id="alertContainer"></div>

    <!-- Floating Help Button (Config page) -->
    <button class="help-button toolbox-button" id="subToolboxLauncher" title="Open Sub Toolbox"
        aria-label="Open Sub Toolbox" style="display:none;" data-i18n="config.actions.openToolbox"
        data-i18n-attr="title,aria-label">
        <span class="toolbox-icon" aria-hidden="true">
            <svg viewBox="0 0 64 64" role="img" focusable="false">
                <defs>
                    <linearGradient id="tbBody" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="#ffb347" />
                        <stop offset="45%" stop-color="#ff7a59" />
                        <stop offset="100%" stop-color="#ff3d7f" />
                    </linearGradient>
                    <linearGradient id="tbLid" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#ffe9a3" />
                        <stop offset="100%" stop-color="#ffc34a" />
                    </linearGradient>
                </defs>
                <rect x="10" y="22" width="44" height="28" rx="6" fill="url(#tbBody)" stroke="#2b0f08"
                    stroke-width="2.2" />
                <path d="M14 30h36" stroke="#2b0f08" stroke-width="2.2" stroke-linecap="round" />
                <rect x="16" y="18" width="32" height="10" rx="3" fill="url(#tbLid)" stroke="#2b0f08"
                    stroke-width="2.2" />
                <rect x="28" y="34" width="8" height="8" rx="2" fill="#ffe9a3" stroke="#2b0f08" stroke-width="1.6" />
                <path d="M26 18v-2a6 6 0 0 1 12 0v2" stroke="#2b0f08" stroke-width="2.2" stroke-linecap="round"
                    fill="none" />
                <circle cx="32" cy="38" r="1.4" fill="#2b0f08" />
                <circle cx="20" cy="26" r="1.8" fill="#2b0f08" opacity="0.35" />
                <circle cx="44" cy="26" r="1.8" fill="#2b0f08" opacity="0.35" />
            </svg>
        </span>
    </button>
    <button class="help-button mario" id="configHelp" title="Help" aria-label="Help" data-i18n="config.quickActionHelp"
        data-i18n-attr="title,aria-label">?</button>

    <!-- Disable native HTML validation: we run all validation in config.js and hidden inputs (provider advanced sliders) can trip browser validity when collapsed -->
    <form id="configForm" autocomplete="off" spellcheck="false" novalidate>

        <!-- No Translation Mode Toggle -->
        <div
            style="margin: 2rem 0; padding: 1.5rem; background: var(--surface-light); border: 2px solid var(--border); border-radius: 12px; display: flex; align-items: center; gap: 1rem;">
            <span style="font-size: 1.75rem;">‚è∏Ô∏è</span>
            <div style="flex: 1;">
                <span id="noTranslationTitle" data-i18n="config.noTranslation.title"
                    style="display: block; font-weight: 600; color: var(--text-primary);">Just Fetch Subtitles (No
                    Translation)</span>
                <span id="noTranslationDescription" data-i18n="config.noTranslation.description"
                    style="display: block; font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">Skip
                    AI translation and just fetch subtitles in your chosen languages</span>
            </div>
            <label class="toggle-switch">
                <input type="checkbox" id="noTranslationMode">
                <span class="toggle-slider"></span>
            </label>
        </div>

        <!-- API Keys Section -->
        <section id="apiKeysSection" class="section-block collapsed">
            <div class="section-header">
                <div class="section-header-left">
                    <div class="section-icon section-emoji" aria-hidden="true">&#128273;</div>
                    <div>
                        <h2 class="section-title" id="apiKeysSectionTitle" data-i18n="config.sections.apiKeysTitle">API
                            Keys</h2>
                        <p class="section-description" id="apiKeysSectionDescription"
                            data-i18n="config.sections.apiKeysDescription">Add and validate your keys for subtitle
                            providers and translation services.</p>
                    </div>
                </div>
                <button type="button" class="collapse-btn section-collapse-btn collapsed"
                    data-collapse-section="api-keys"></button>
            </div>
            <div class="section-grid">
                <!-- Subtitle API Providers -->
                <div class="card collapsed" data-card="subtitle-api">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <g fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <rect x="9" y="14" width="14" height="12" rx="2.5" ry="2.5" />
                                        <path d="M12 14v-2a4 4 0 0 1 8 0v2" />
                                        <circle cx="16" cy="20" r="2" />
                                        <path d="M16 22v2" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" id="subtitleApiTitle" data-i18n="config.sections.subtitleApiTitle">
                                Subtitles API Keys</h2>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="subtitle-api"></button>
                    </div>
                    <div class="card-content">
                        <!-- OpenSubtitles -->
                        <div class="form-group" style="padding-bottom: 1.5rem; border-bottom: 1px solid var(--border);">
                            <div
                                style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                                <label style="margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.5rem;">üìÑ</span>
                                    <div>
                                        <strong id="opensubsTitle" data-i18n="config.opensubs.title"
                                            style="display: block;">OpenSubtitles</strong>
                                        <span id="opensubsImplDescription" class="label-description"
                                            data-i18n="config.opensubs.implDescription" style="margin: 0;">Choose your
                                            preferred OpenSubtitles
                                            implementation.</span>
                                    </div>
                                </label>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="enableOpenSubtitles" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div id="opensubtitlesConfig">
                                <!-- Implementation Type Selection -->
                                <div
                                    style="margin-bottom: 1rem; padding: 1rem; background: var(--surface-light); border-radius: 8px;">
                                    <label id="opensubsImplTypeLabel" data-i18n="config.opensubs.implementationType"
                                        style="display: block; margin-bottom: 0.75rem; font-weight: 600;">Implementation
                                        Type</label>
                                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                                        <label
                                            style="display: flex; align-items: start; gap: 0.5rem; cursor: pointer; padding: 0.75rem; background: white; border: 2px solid var(--border); border-radius: 8px; transition: all 0.2s;">
                                            <input type="radio" name="opensubtitlesImplementation"
                                                id="opensubtitlesImplV3" value="v3" checked
                                                style="margin-top: 0.25rem;">
                                            <div style="flex: 1;">
                                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                                    <strong id="opensubsV3Title" data-i18n="config.opensubs.v3Title"
                                                        style="margin-bottom: 0.25rem;">V3 (Default)</strong>
                                                    <div class="v3-warning-tooltip">
                                                        <span class="warning-icon" tabindex="0"
                                                            aria-label="OpenSubtitles V3 limitations"
                                                            data-i18n="config.opensubs.v3Tooltip"
                                                            data-i18n-attr="aria-label">&#9888;&#65039;</span>
                                                        <div class="tooltip-bubble" role="tooltip" aria-hidden="true"
                                                            id="opensubsV3Tooltip"
                                                            data-i18n="config.opensubs.v3Tooltip">
                                                            V3 doesn't show all OpenSubtitles results and rate-limiting
                                                            may apply.
                                                        </div>
                                                    </div>
                                                </div>
                                                <span id="opensubsV3Description" class="label-description"
                                                    data-i18n="config.opensubs.v3Description"
                                                    style="margin: 0; font-size: 0.875rem;">Uses the
                                                    official Stremio OpenSubtitles V3 addon. No authentication required,
                                                    simple setup.</span>
                                            </div>
                                        </label>
                                        <label
                                            style="display: flex; align-items: start; gap: 0.5rem; cursor: pointer; padding: 0.75rem; background: white; border: 2px solid var(--border); border-radius: 8px; transition: all 0.2s;">
                                            <input type="radio" name="opensubtitlesImplementation"
                                                id="opensubtitlesImplAuth" value="auth" style="margin-top: 0.25rem;">
                                            <div>
                                                <strong id="opensubsAuthTitle" data-i18n="config.opensubs.authTitle"
                                                    style="display: block; margin-bottom: 0.25rem;">Auth
                                                    (Recommended)</strong>
                                                <span id="opensubsAuthDescription" class="label-description"
                                                    data-i18n="config.opensubs.authDescription"
                                                    style="margin: 0; font-size: 0.875rem;">Uses your OpenSubtitles.com
                                                    account. Requires username/password. <a
                                                        href="https://www.opensubtitles.com/en/newuser" target="_blank"
                                                        style="color: var(--primary-light);">Create
                                                        account</a></span>
                                            </div>
                                        </label>
                                    </div>
                                </div>

                                <!-- Auth Configuration (shown when Auth is selected) -->
                                <div id="opensubtitlesAuthConfig" style="display: none;">
                                    <div class="opensubs-auth-layout">
                                        <div class="opensubs-auth-fields">
                                            <label id="opensubsUsernameLabel" data-i18n="config.opensubs.usernameLabel"
                                                style="display: block;">Username</label>
                                            <input type="text" id="opensubtitlesUsername" name="opensubtitlesUsername"
                                                placeholder="Enter OpenSubtitles Username" autocomplete="username"
                                                data-i18n="config.opensubs.usernamePlaceholder"
                                                data-i18n-attr="placeholder" autocapitalize="none" autocorrect="off"
                                                spellcheck="false">

                                            <label id="opensubsPasswordLabel" data-i18n="config.opensubs.passwordLabel"
                                                style="display: block;">Password</label>
                                            <div class="password-field-wrapper">
                                                <input type="text" class="sensitive-input masked"
                                                    id="opensubtitlesPassword" name="opensubtitlesPassword"
                                                    placeholder="Enter OpenSubtitles Password"
                                                    data-i18n="config.opensubs.passwordPlaceholder"
                                                    data-i18n-attr="placeholder" autocomplete="current-password"
                                                    autocapitalize="none" autocorrect="off" spellcheck="false"
                                                    inputmode="text">
                                                <span class="password-toggle-icon" id="toggleOpenSubsPassword"
                                                    title="Show/hide password"
                                                    data-i18n="config.opensubs.showHidePassword"
                                                    data-i18n-attr="title">&#128274;&#128065;</span>
                                            </div>

                                            <span id="opensubsRateNote" class="label-description"
                                                data-i18n="config.opensubs.rateNote">20 subtitles a day. <a
                                                    href="https://www.opensubtitles.com/en/newuser" target="_blank"
                                                    style="color: var(--primary-light);">Create a free account</a> if
                                                you don't
                                                have one.</span>
                                        </div>

                                        <div class="validate-tile">
                                            <div class="tile-eyebrow" style="text-align:center;"
                                                data-i18n="config.opensubs.pingHint">Run a quick ping before saving
                                                to validate your credentials.</div>
                                            <button type="button" class="validate-api-btn" id="validateOpenSubtitles"
                                                title="Validate OpenSubtitles credentials"
                                                data-i18n="config.opensubs.validateTitle" data-i18n-attr="title">
                                                <span class="validate-icon">&#10003;</span>
                                                <span class="validate-text" data-i18n="config.opensubs.validateCta">Run
                                                    Test</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="validation-feedback" id="opensubtitlesValidationFeedback"></div>
                                </div>
                            </div>
                        </div>

                        <!-- SubSource -->
                        <div class="form-group" style="padding: 1.5rem 0; border-bottom: 1px solid var(--border);">
                            <div
                                style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                                <label style="margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.5rem;">üé¨</span>
                                    <div>
                                        <strong id="subsourceTitle" data-i18n="config.providers.subsource.title"
                                            style="display: block;">SubSource</strong>
                                        <span class="label-description" id="subsourceDescription" style="margin: 0;">
                                            <span data-i18n="config.providers.subsource.description">Get your free API
                                                key from</span>
                                            <a id="subsourceLink" data-i18n="config.providers.subsource.linkLabel"
                                                href="https://subsource.net/" target="_blank"
                                                style="color: var(--primary-light);">SubSource.net</a>
                                        </span>
                                    </div>
                                </label>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="enableSubSource" aria-label="SubSource toggle"
                                        data-i18n="config.providers.subsource.toggleLabel" data-i18n-attr="aria-label"
                                        checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div id="subsourceConfig">
                                <div style="display: flex; gap: 0.5rem; align-items: start;">
                                    <input type="text" id="subsourceApiKey"
                                        data-i18n="config.providers.subsource.placeholder" data-i18n-attr="placeholder"
                                        placeholder="Enter SubSource API key" style="flex: 1;">
                                    <button type="button" class="validate-api-btn" id="validateSubSource"
                                        data-i18n="config.providers.subsource.validateTitle" data-i18n-attr="title"
                                        title="Validate API key">
                                        <span class="validate-icon">‚úì</span>
                                        <span class="validate-text"
                                            data-i18n="config.providers.subsource.validateCta">Test</span>
                                    </button>
                                </div>
                                <div class="validation-feedback" id="subsourceValidationFeedback"></div>
                            </div>
                        </div>

                        <!-- SubDL -->
                        <div class="form-group" style="padding: 1.5rem 0; border-bottom: 1px solid var(--border);">
                            <div
                                style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                                <label style="margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.5rem;">üìã</span>
                                    <div>
                                        <strong id="subdlTitle" data-i18n="config.providers.subdl.title"
                                            style="display: block;">SubDL</strong>
                                        <span class="label-description" id="subdlDescription" style="margin: 0;">
                                            <span data-i18n="config.providers.subdl.description">Get your free API key
                                                from</span>
                                            <a id="subdlLink" data-i18n="config.providers.subdl.linkLabel"
                                                href="https://subdl.com" target="_blank"
                                                style="color: var(--primary-light);">SubDL.com</a>
                                        </span>
                                    </div>
                                </label>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="enableSubDL" aria-label="SubDL toggle"
                                        data-i18n="config.providers.subdl.toggleLabel" data-i18n-attr="aria-label"
                                        checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div id="subdlConfig">
                                <div style="display: flex; gap: 0.5rem; align-items: start;">
                                    <input type="text" id="subdlApiKey" data-i18n="config.providers.subdl.placeholder"
                                        data-i18n-attr="placeholder" placeholder="Enter SubDL API key" style="flex: 1;">
                                    <button type="button" class="validate-api-btn" id="validateSubDL"
                                        data-i18n="config.providers.subdl.validateTitle" data-i18n-attr="title"
                                        title="Validate API key">
                                        <span class="validate-icon">‚úì</span>
                                        <span class="validate-text"
                                            data-i18n="config.providers.subdl.validateCta">Test</span>
                                    </button>
                                </div>
                                <div class="validation-feedback" id="subdlValidationFeedback"></div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Gemini API -->
                <div class="card collapsed" id="geminiCard" data-card="gemini">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="16" cy="16" r="10.5" stroke-width="2.2" />
                                        <circle cx="16" cy="16" r="5" stroke-width="1.8" />
                                        <path
                                            d="M16 6v-2M22.5 8.2l1.4-1.4M26 15h2M22.5 23.8l1.4 1.4M16 26v2M9.5 23.8l-1.4 1.4M6 15H4M9.5 8.2 8.1 6.8"
                                            stroke-width="1.15" />
                                        <path d="M16 11v4.2l2.8 1.6" stroke-width="1.8" />
                                        <path d="M12.8 21.4c0.7 1 1.9 1.6 3.2 1.6s2.5-0.6 3.2-1.6" stroke-width="1.2"
                                            opacity="0.8" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" data-i18n="config.gemini.title">AI Translation API Keys</h2>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="gemini"></button>
                    </div>
                    <div class="card-content">
                        <div class="form-group" id="geminiSingleKeyGroup">
                            <label for="geminiApiKey">
                                <span data-i18n="config.gemini.apiKey.label">Gemini API Key</span>
                                <span class="label-description" id="geminiApiHelper">
                                    <span data-i18n="config.gemini.apiKey.helper">Get your free API key from</span>
                                    <a data-i18n="config.gemini.apiKey.linkLabel"
                                        href="https://makersuite.google.com/app/apikey" target="_blank"
                                        style="color: var(--primary-light);">Google AI Studio</a>
                                </span>
                            </label>
                            <div class="gemini-key-input-wrapper">
                                <div class="password-field-wrapper" style="flex: 1; min-width: 0;">
                                    <input type="text" class="sensitive-input masked" id="geminiApiKey"
                                        placeholder="Enter your Gemini API key"
                                        data-i18n="config.gemini.apiKey.placeholder" data-i18n-attr="placeholder"
                                        autocomplete="off" autocapitalize="none" autocorrect="off" spellcheck="false"
                                        inputmode="text">
                                    <span class="password-toggle-icon" id="toggleGeminiApiKey" title="Show/hide API key"
                                        data-i18n="config.gemini.apiKey.showHideKey"
                                        data-i18n-attr="title">&#128274;&#128065;</span>
                                </div>
                                <button type="button" class="validate-api-btn compact" id="validateGemini"
                                    title="Validate API key" data-i18n="config.gemini.apiKey.validateTitle"
                                    data-i18n-attr="title">
                                    <span class="validate-icon">‚úì</span>
                                    <span class="validate-text" data-i18n="config.gemini.apiKey.validateCta">Test</span>
                                </button>
                            </div>
                            <div class="validation-feedback" id="geminiValidationFeedback"></div>
                            <div class="field-error" id="geminiApiKeyError"
                                data-i18n="config.validation.geminiKeyRequired">API key is required</div>
                        </div>

                        <!-- Dynamic API Keys List (shown when rotation is enabled) -->
                        <div id="geminiApiKeysContainer" class="api-keys-list"
                            style="display: none; padding: 0.75rem; background: var(--surface-elevated); border-radius: 8px;">
                            <label style="display: block; margin-bottom: 0.35rem;">
                                <span data-i18n="config.gemini.keyRotation.additionalKeysLabel">Additional API
                                    Keys</span>
                                <span class="label-description" id="geminiKeysCountLabel">(+0 additional)</span>
                            </label>
                            <div id="geminiApiKeysList" class="dynamic-keys-list">
                                <!-- Dynamic key inputs will be added here -->
                            </div>
                            <div style="display: flex; justify-content: flex-end; margin-top: 0.5rem;">
                                <button type="button" id="addGeminiKeyBtn" class="btn btn-secondary btn-sm">
                                    <span>+</span> <span data-i18n="config.gemini.keyRotation.addKey">Add Key</span>
                                </button>
                            </div>
                            <div class="field-error" id="geminiApiKeysError"
                                data-i18n="config.validation.geminiKeysRequired" style="display: none;">At least one
                                API key is required for rotation</div>

                            <!-- Key Rotation Mode Selector -->
                            <div class="form-group"
                                style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--border);">
                                <label for="geminiKeyRotationMode">
                                    <span data-i18n="config.gemini.keyRotation.modeLabel">Rotation Frequency</span>
                                    <span class="label-description"
                                        data-i18n="config.gemini.keyRotation.modeDescription">
                                        How often to switch between API keys
                                    </span>
                                </label>
                                <select id="geminiKeyRotationMode">
                                    <option value="per-request" data-i18n="config.gemini.keyRotation.modePerRequest">Per
                                        Request (once per
                                        file)</option>
                                    <option value="per-batch" data-i18n="config.gemini.keyRotation.modePerBatch">Per
                                        Batch (each translation batch)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="geminiModel">
                                <span data-i18n="config.gemini.model.label">Translation Model</span>
                                <span class="label-description" data-i18n="config.gemini.model.helper">AI model for
                                    translations</span>
                            </label>
                            <select id="geminiModel" required>
                                <option value="gemini-flash-lite-latest"
                                    data-i18n="config.gemini.model.options.flashLite">Gemini 2.5 Flash-Lite</option>
                                <option value="gemini-2.5-flash-preview-09-2025"
                                    data-i18n="config.gemini.model.options.flash" selected>Gemini 2.5 Flash</option>
                                <option value="gemini-3-flash-preview" data-i18n="config.gemini.model.options.flash3">
                                    Gemini 3.0 Flash (beta)</option>
                                <option value="gemini-2.5-pro" data-i18n="config.gemini.model.options.pro">Gemini 2.5
                                    Pro (beta)</option>
                                <option value="gemini-3-pro-preview" data-i18n="config.gemini.model.options.pro3">
                                    Gemini 3.0 Pro (beta)</option>
                            </select>
                            <div class="field-error" id="geminiModelError"
                                data-i18n="config.validation.geminiModelRequired">Please select a model</div>
                            <div
                                style="margin-top: 0.6rem; padding: 0.75rem; background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 8px; font-size: 0.875rem; color: var(--text-secondary);">
                                <strong style="color: var(--warning);"
                                    data-i18n="config.gemini.model.retranslationHintTitle">Bad/broken or out-of-sync
                                    translation?</strong> <span
                                    data-i18n="config.gemini.model.retranslationHintBody">Quickly triple-click the
                                    subtitle to force a re-translation.</span>
                            </div>
                            <div id="proRateLimitWarning"
                                style="display: none; margin-top: 0.75rem; padding: 0.75rem; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; font-size: 0.875rem; color: var(--text-secondary);">
                                <strong style="color: #ef4444;" data-i18n="config.gemini.model.rateWarningTitle">‚ö†Ô∏è Free
                                    Tier Limitation:</strong> <span data-i18n="config.gemini.model.rateWarningBody">If
                                    using a free API key,
                                    Gemini 2.5 Pro may trigger rate limits (HTTP 429). You'll likely only be able to
                                    translate one
                                    subtitle at a time.</span>
                            </div>
                        </div>

                        <div class="form-group" style="display: none;">
                            <label for="promptStyle">
                                <span data-i18n="config.translationSettings.promptStyle.label">Prompt Style</span>
                                <span class="label-description"
                                    data-i18n="config.translationSettings.promptStyle.description">Choose between strict
                                    structure preservation or natural flow
                                    adaptation</span>
                            </label>
                            <select id="promptStyle">
                                <option value="natural" disabled title="Temporarily unavailable"
                                    data-i18n="config.translationSettings.promptStyle.options.natural">Natural - Adapts
                                    structure for
                                    natural target language flow</option>
                                <option value="strict"
                                    data-i18n="config.translationSettings.promptStyle.options.strict">Strict - Preserves
                                    exact timing and structure</option>
                            </select>
                        </div>

                        <!-- Gemini API Key Rotation Toggle -->
                        <div class="form-group" id="geminiKeyRotationGroup"
                            style="margin-top: 1.25rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                            <label style="display:flex; align-items:center; gap:0.5rem;">
                                <input type="checkbox" id="geminiKeyRotationEnabled">
                                <span data-i18n="config.gemini.keyRotation.label">Enable Gemini API key rotation</span>
                            </label>
                            <span class="label-description" data-i18n="config.gemini.keyRotation.description">Distribute
                                API calls across multiple keys to avoid rate limits.</span>
                        </div>

                        <!-- Advanced Settings removed by request -->
                        <div class="form-group" id="multiProvidersGroup">
                            <label style="display:flex; align-items:center; gap:0.5rem;">
                                <input type="checkbox" id="enableMultiProviders">
                                <span data-i18n="config.multiProvider.label">Multiple providers (beta)</span>
                            </label>
                            <span class="label-description" data-i18n="config.multiProvider.description">Enables
                                multiple AI providers. You can set primary/secondary providers in "Translation
                                Settings".</span>
                        </div>

                        <div id="multiProvidersContainer"
                            style="display: none; background: var(--surface-light); border: 1px solid var(--border); border-radius: 10px; padding: 1rem; margin-top: 0.5rem; flex-direction: column; gap: 1rem;">
                            <div style="display: grid; gap: 1rem;">
                                <div class="provider-block" data-provider="openai">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-openai-enabled"> OpenAI
                                        </label>
                                        <button type="button" class="validate-api-btn" data-provider="openai"
                                            title="Fetch models" data-i18n="config.providersUi.loadModelsTitle"
                                            data-i18n-attr="title">
                                            <span class="validate-icon">&#8635;</span>
                                            <span class="validate-text" data-i18n="config.providersUi.loadModels">Load
                                                Models</span>
                                        </button>
                                    </div>
                                    <div id="provider-openai-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="text" id="provider-openai-key" placeholder="OpenAI API key"
                                            data-i18n="config.providersUi.placeholders.openai"
                                            data-i18n-attr="placeholder" class="sensitive-input masked">
                                        <select id="provider-openai-model">
                                            <option value="" data-i18n="config.providersUi.selectModel">Select model
                                            </option>
                                        </select>
                                    </div>
                                </div>

                                <div class="provider-block" data-provider="anthropic">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-anthropic-enabled"> Anthropic
                                        </label>
                                        <button type="button" class="validate-api-btn" data-provider="anthropic"
                                            title="Fetch models" data-i18n="config.providersUi.loadModelsTitle"
                                            data-i18n-attr="title">
                                            <span class="validate-icon">&#8635;</span>
                                            <span class="validate-text" data-i18n="config.providersUi.loadModels">Load
                                                Models</span>
                                        </button>
                                    </div>
                                    <div id="provider-anthropic-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="text" id="provider-anthropic-key" placeholder="Anthropic API key"
                                            data-i18n="config.providersUi.placeholders.anthropic"
                                            data-i18n-attr="placeholder" class="sensitive-input masked">
                                        <select id="provider-anthropic-model">
                                            <option value="" data-i18n="config.providersUi.selectModel">Select model
                                            </option>
                                        </select>
                                    </div>
                                </div>

                                <div class="provider-block" data-provider="xai">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-xai-enabled"> XAI (Grok)
                                        </label>
                                        <button type="button" class="validate-api-btn" data-provider="xai"
                                            title="Fetch models" data-i18n="config.providersUi.loadModelsTitle"
                                            data-i18n-attr="title">
                                            <span class="validate-icon">&#8635;</span>
                                            <span class="validate-text" data-i18n="config.providersUi.loadModels">Load
                                                Models</span>
                                        </button>
                                    </div>
                                    <div id="provider-xai-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="text" id="provider-xai-key" placeholder="XAI API key"
                                            data-i18n="config.providersUi.placeholders.xai" data-i18n-attr="placeholder"
                                            class="sensitive-input masked">
                                        <select id="provider-xai-model">
                                            <option value="" data-i18n="config.providersUi.selectModel">Select model
                                            </option>
                                        </select>
                                    </div>
                                </div>

                                <div class="provider-block" data-provider="deepseek">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-deepseek-enabled"> DeepSeek
                                        </label>
                                        <button type="button" class="validate-api-btn" data-provider="deepseek"
                                            title="Fetch models" data-i18n="config.providersUi.loadModelsTitle"
                                            data-i18n-attr="title">
                                            <span class="validate-icon">&#8635;</span>
                                            <span class="validate-text" data-i18n="config.providersUi.loadModels">Load
                                                Models</span>
                                        </button>
                                    </div>
                                    <div id="provider-deepseek-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="text" id="provider-deepseek-key" placeholder="DeepSeek API key"
                                            data-i18n="config.providersUi.placeholders.deepseek"
                                            data-i18n-attr="placeholder" class="sensitive-input masked">
                                        <select id="provider-deepseek-model">
                                            <option value="" data-i18n="config.providersUi.selectModel">Select model
                                            </option>
                                        </select>
                                    </div>
                                </div>

                                <div class="provider-block" data-provider="deepl">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-deepl-enabled"> DeepL
                                        </label>
                                        <button type="button" class="validate-api-btn" data-provider="deepl"
                                            title="Fetch models" data-i18n="config.providersUi.loadModelsTitle"
                                            data-i18n-attr="title">
                                            <span class="validate-icon">&#8635;</span>
                                            <span class="validate-text" data-i18n="config.providersUi.loadModels">Load
                                                Models</span>
                                        </button>
                                    </div>
                                    <div id="provider-deepl-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="text" id="provider-deepl-key" placeholder="DeepL Auth Key"
                                            data-i18n="config.providersUi.placeholders.deepl"
                                            data-i18n-attr="placeholder" class="sensitive-input masked">
                                        <select id="provider-deepl-model">
                                            <option value="" data-i18n="config.providersUi.selectModel">Select model
                                            </option>
                                        </select>
                                        <span class="label-description" data-i18n="config.providersUi.deeplHint">Free
                                            keys auto-use api-free.deepl.com. Language codes
                                            are auto-mapped from your selections.</span>
                                    </div>
                                </div>

                                <div class="provider-block" data-provider="mistral">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-mistral-enabled"> Mistral
                                        </label>
                                        <button type="button" class="validate-api-btn" data-provider="mistral"
                                            title="Fetch models" data-i18n="config.providersUi.loadModelsTitle"
                                            data-i18n-attr="title">
                                            <span class="validate-icon">&#8635;</span>
                                            <span class="validate-text" data-i18n="config.providersUi.loadModels">Load
                                                Models</span>
                                        </button>
                                    </div>
                                    <div id="provider-mistral-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="text" id="provider-mistral-key" placeholder="Mistral API key"
                                            data-i18n="config.providersUi.placeholders.mistral"
                                            data-i18n-attr="placeholder" class="sensitive-input masked">
                                        <select id="provider-mistral-model">
                                            <option value="" data-i18n="config.providersUi.selectModel">Select model
                                            </option>
                                        </select>
                                    </div>
                                </div>

                                <div class="provider-block" data-provider="cfworkers">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-cfworkers-enabled"> Cloudflare Workers
                                            AI
                                        </label>
                                        <button type="button" class="validate-api-btn" data-provider="cfworkers"
                                            title="Fetch models" data-i18n="config.providersUi.loadModelsTitle"
                                            data-i18n-attr="title">
                                            <span class="validate-icon">&#8635;</span>
                                            <span class="validate-text" data-i18n="config.providersUi.loadModels">Load
                                                Models</span>
                                        </button>
                                    </div>
                                    <div id="provider-cfworkers-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="text" id="provider-cfworkers-key" placeholder="ACCOUNT_ID|TOKEN"
                                            data-i18n="config.providersUi.placeholders.cfworkers"
                                            data-i18n-attr="placeholder" class="sensitive-input">
                                        <select id="provider-cfworkers-model">
                                            <option value="" data-i18n="config.providersUi.selectModel">Select model
                                            </option>
                                        </select>
                                        <span class="label-description" data-i18n="config.providersUi.cfworkersHint">Use
                                            ACCOUNT|TOKEN to set account ID explicitly.</span>
                                    </div>
                                </div>

                                <div class="provider-block" data-provider="openrouter">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-openrouter-enabled"> OpenRouter
                                        </label>
                                        <button type="button" class="validate-api-btn" data-provider="openrouter"
                                            title="Fetch models" data-i18n="config.providersUi.loadModelsTitle"
                                            data-i18n-attr="title">
                                            <span class="validate-icon">&#8635;</span>
                                            <span class="validate-text" data-i18n="config.providersUi.loadModels">Load
                                                Models</span>
                                        </button>
                                    </div>
                                    <div id="provider-openrouter-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="text" id="provider-openrouter-key" placeholder="OpenRouter API key"
                                            data-i18n="config.providersUi.placeholders.openrouter"
                                            data-i18n-attr="placeholder" class="sensitive-input masked">
                                        <select id="provider-openrouter-model">
                                            <option value="" data-i18n="config.providersUi.selectModel">Select model
                                            </option>
                                        </select>
                                    </div>
                                </div>

                                <div class="provider-block" data-provider="googletranslate">
                                    <div
                                        style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem;">
                                        <label
                                            style="font-weight:600; margin:0; display:flex; align-items:center; gap:0.35rem;">
                                            <input type="checkbox" id="provider-googletranslate-enabled"> Google
                                            Translate
                                            (unofficial)
                                        </label>
                                        <div style="font-size:0.85rem; color: var(--text-secondary);"
                                            data-i18n="config.providersUi.noKeyNeeded">No API key needed</div>
                                    </div>
                                    <div id="provider-googletranslate-fields" class="provider-fields"
                                        style="display:none; margin-top:0.5rem; display: grid; gap: 0.5rem;">
                                        <input type="hidden" id="provider-googletranslate-key" value="">
                                        <select id="provider-googletranslate-model" disabled>
                                            <option value="web" selected data-i18n="config.providersUi.googleWeb">web
                                                (fixed)</option>
                                        </select>
                                        <div style="font-size:0.9rem; color: var(--text-secondary);"
                                            data-i18n="config.providersUi.googleHint">Uses the public Google
                                            Translate web endpoint (may be unstable).</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>



                <!-- Other API Keys -->
                <div class="card collapsed" id="otherApiKeysCard" data-card="other-api" style="display: none;">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <g fill="none" stroke="currentColor" stroke-width="2.1" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M12 5.5h8l6 5v11l-6 5h-8l-6-5v-11z" />
                                        <circle cx="16" cy="12.25" r="3" />
                                        <path d="M16 15.5v3.75l-2 1.8" />
                                        <path d="M18.25 22.5H13.8" />
                                        <path d="M4.25 16h3.6m16.3 0h3.6" />
                                        <circle cx="4.25" cy="16" r="1.35" />
                                        <circle cx="27.75" cy="16" r="1.35" />
                                        <path d="M16 5.5V3m0 26v-3" />
                                        <circle cx="16" cy="2.75" r="1.25" />
                                        <circle cx="16" cy="27.25" r="1.25" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" data-i18n="config.otherApiKeys.title">Other API Keys</h2>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="other-api"></button>
                    </div>
                    <div class="card-content">
                        <div class="form-group"
                            style="padding-bottom: 1.25rem; border-bottom: 1px solid var(--border); margin-bottom: 1.25rem;">
                            <label for="cloudflareWorkersApiKey">
                                <span data-i18n="config.otherApiKeys.cloudflare.label">Cloudflare Workers AI
                                    (Auto-Subs)</span>
                                <span class="label-description" data-i18n="config.otherApiKeys.cloudflare.helper">Used
                                    by Automatic Subtitles via xSync. Format: ACCOUNT_ID|TOKEN.</span>
                            </label>
                            <div style="display: flex; gap: 0.5rem; align-items: start;">
                                <input type="text" class="sensitive-input masked" id="cloudflareWorkersApiKey"
                                    placeholder="ACCOUNT_ID|TOKEN"
                                    data-i18n="config.otherApiKeys.cloudflare.placeholder" data-i18n-attr="placeholder"
                                    style="flex: 1;" autocomplete="off" autocapitalize="none" autocorrect="off"
                                    spellcheck="false" inputmode="text">
                                <button type="button" class="validate-api-btn" id="validateCloudflareWorkers"
                                    title="Validate Cloudflare Workers AI key"
                                    data-i18n="config.otherApiKeys.cloudflare.validateTitle" data-i18n-attr="title">
                                    <span class="validate-icon">‚úì</span>
                                    <span class="validate-text"
                                        data-i18n="config.otherApiKeys.cloudflare.validateCta">Test</span>
                                </button>
                            </div>
                            <div class="validation-feedback" id="cloudflareWorkersValidationFeedback"></div>
                            <div class="field-error" id="cloudflareWorkersApiKeyError"
                                data-i18n="config.validation.cloudflareWorkersKeyRequired">API key is required for
                                Cloudflare Workers auto-subs</div>
                        </div>
                        <div class="form-group">
                            <label for="assemblyAiApiKey">
                                <span data-i18n="config.otherApiKeys.assembly.label">AssemblyAI API Key</span>
                                <span class="label-description" data-i18n="config.otherApiKeys.assembly.helper">Used for
                                    Automatic Subtitles via AssemblyAI.</span>
                            </label>
                            <div style="display: flex; gap: 0.5rem; align-items: start;">
                                <input type="text" class="sensitive-input masked" id="assemblyAiApiKey"
                                    placeholder="Enter your AssemblyAI API key"
                                    data-i18n="config.otherApiKeys.assembly.placeholder" data-i18n-attr="placeholder"
                                    style="flex: 1;" autocomplete="off" autocapitalize="none" autocorrect="off"
                                    spellcheck="false" inputmode="text">
                                <button type="button" class="validate-api-btn" id="validateAssemblyAi"
                                    title="Validate AssemblyAI API key"
                                    data-i18n="config.otherApiKeys.assembly.validateTitle" data-i18n-attr="title">
                                    <span class="validate-icon">‚úì</span>
                                    <span class="validate-text"
                                        data-i18n="config.otherApiKeys.assembly.validateCta">Test</span>
                                </button>
                            </div>
                            <div class="validation-feedback" id="assemblyAiValidationFeedback"></div>
                            <div class="field-error" id="assemblyAiApiKeyError"
                                data-i18n="config.validation.assemblyAiKeyRequired">API key is required for AssemblyAI
                                mode</div>
                        </div>
                    </div>
                </div>

                <div class="section-footer">
                    <button type="button" class="section-close-link collapsed" data-section-close="api-keys">
                        <span class="section-close-icon" aria-hidden="true">√ó</span>
                        <span data-i18n="config.sections.closeLink">Close section</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Languages Section -->
        <section id="languagesSection" class="section-block collapsed">
            <div class="section-header">
                <div class="section-header-left">
                    <div class="section-icon section-emoji language-emoji" aria-hidden="true">&#127760;</div>
                    <div>
                        <h2 class="section-title" id="languagesSectionTitle" data-i18n="config.sections.languagesTitle">
                            Languages</h2>
                        <p class="section-description" id="languagesSectionDescription"
                            data-i18n="config.sections.languagesDescription">Choose your source and target languages for
                            fetching and translations.</p>
                    </div>
                </div>
                <button type="button" class="collapse-btn section-collapse-btn collapsed"
                    data-collapse-section="languages"></button>
            </div>
            <div class="section-grid">

                <!-- No-Translation Languages (flat, shown only in Just Fetch mode) -->
                <div class="card" id="noTranslationCard" style="display: none;" data-card="notranslation">
                    <div class="card-content">
                        <div class="form-group">
                            <label>
                                <span data-i18n="config.noTranslationCard.label">Subtitle Languages</span>
                                <span class="label-description" id="noTranslationLanguagesDescription"
                                    data-i18n="config.limits.noTranslationDescription">Select which languages
                                    you want to fetch subtitles in.</span>
                            </label>

                            <div class="language-search">
                                <span class="language-search-icon">&#x1F50D;</span>
                                <input type="text" id="noTranslationSearch" data-i18n="config.noTranslationCard.search"
                                    data-i18n-attr="placeholder" placeholder="Search languages...">
                            </div>

                            <div id="selectedNoTranslationLanguages" class="selected-languages empty"></div>
                            <div class="field-error" id="noTranslationLanguagesError"
                                data-i18n="config.validation.noTranslationRequired"></div>

                            <div class="quick-actions">
                                <button type="button" class="quick-btn" data-action="select-popular-notranslation">
                                    <span aria-hidden="true">&#x2B50;</span>
                                    <span data-i18n="config.noTranslationCard.quickPopular">Popular</span>
                                </button>
                                <button type="button" class="quick-btn" data-action="select-all-notranslation">
                                    <span aria-hidden="true">&#x2713;</span>
                                    <span data-i18n="config.noTranslationCard.quickAll">All</span>
                                </button>
                                <button type="button" class="quick-btn" data-action="clear-notranslation">
                                    <span aria-hidden="true">&#x2717;</span>
                                    <span data-i18n="config.noTranslationCard.quickClear">Clear</span>
                                </button>
                            </div>

                            <div id="noTranslationLanguages" class="language-grid"></div>
                        </div>
                    </div>
                </div>

                <!-- Source Languages -->
                <div class="card collapsed" id="sourceCard" data-card="source">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <g fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <circle cx="16" cy="11" r="4" />
                                        <path d="M10 18c0-2.5 2.7-4 6-4s6 1.5 6 4" />
                                        <path d="M8 23c-.5-1-1.5-2-3-2M24 23c.5-1 1.5-2 3-2" />
                                        <path d="M6 26h20" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" data-i18n="config.languageCards.sourceTitle">Source Languages</h2>
                            <span class="card-badge" id="sourceBadge">0</span>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="source"></button>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>
                                <span data-i18n="config.languageCards.sourceLabel">* Source languages for
                                    translations</span>
                                <span class="label-description" id="sourceLanguagesDescription"
                                    data-i18n="config.limits.sourceDescription">You can select up to 3 source
                                    languages, but only 1 is recommended (so you have the same list order when
                                    translating). All
                                    subtitles from this language will be available for translation in the translation
                                    selector
                                    AND will be fetched (original subtitles will show up).</span>
                            </label>

                            <div class="language-search">
                                <span class="language-search-icon">üîç</span>
                                <input type="text" id="sourceSearch" data-i18n="config.languageCards.search"
                                    data-i18n-attr="placeholder" placeholder="Search languages..." accesskey="s">
                            </div>

                            <div id="selectedSourceLanguages" class="selected-languages empty"></div>
                            <div class="field-error" id="sourceLanguagesError"
                                data-i18n="config.validation.sourceRequired">Please select at least one source language
                            </div>

                            <div id="sourceLanguages" class="language-grid"></div>
                        </div>
                    </div>
                </div>

                <!-- Target Languages -->
                <div class="card collapsed" id="targetCard" data-card="target">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <g fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <circle cx="16" cy="16" r="10" />
                                        <circle cx="16" cy="16" r="6" />
                                        <circle cx="16" cy="16" r="2" fill="currentColor" />
                                        <path d="M16 6v4M16 22v4M6 16h4M22 16h4" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" data-i18n="config.languageCards.targetTitle">Target Languages</h2>
                            <span class="card-badge" id="targetBadge">0</span>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="target"></button>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>
                                <span data-i18n="config.languageCards.targetLabel">* Target languages for subtitles and
                                    translations</span>
                                <span class="label-description" id="targetLanguagesDescription"
                                    data-i18n="config.limits.targetDescription">Subtitles in target languages
                                    will be fetched AND translation buttons will appear for translating FROM the source
                                    language
                                    TO these languages. You can select up to 6 total target languages (including Learn
                                    Mode).</span>
                            </label>

                            <div class="language-search">
                                <span class="language-search-icon">üîç</span>
                                <input type="text" id="targetSearch" data-i18n="config.languageCards.search"
                                    data-i18n-attr="placeholder" placeholder="Search languages..." accesskey="t">
                            </div>

                            <div id="selectedTargetLanguages" class="selected-languages empty"></div>
                            <div class="field-error" id="targetLanguagesError"
                                data-i18n="config.validation.targetRequired">Please select at least one target language
                            </div>

                            <div class="quick-actions">
                                <button type="button" class="quick-btn" data-action="select-popular-target">
                                    <span aria-hidden="true">‚≠ê</span>
                                    <span data-i18n="config.languageCards.quickPopular">Popular</span>
                                </button>
                                <button type="button" class="quick-btn" data-action="select-all-target">
                                    <span aria-hidden="true">‚úì</span>
                                    <span data-i18n="config.languageCards.quickAll">All</span>
                                </button>
                                <button type="button" class="quick-btn" data-action="clear-target">
                                    <span aria-hidden="true">‚úó</span>
                                    <span data-i18n="config.languageCards.quickClear">Clear</span>
                                </button>
                            </div>

                            <div id="targetLanguages" class="language-grid"></div>
                        </div>
                    </div>
                </div>

                <!-- Learn Target Languages -->
                <div class="card collapsed" id="learnTargetsCard" style="display: none;" data-card="learn">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <defs>
                                        <linearGradient id="learnAurora" x1="10%" y1="15%" x2="90%" y2="85%">
                                            <stop offset="0%" stop-color="currentColor" stop-opacity="0.15" />
                                            <stop offset="45%" stop-color="currentColor" stop-opacity="0.05" />
                                            <stop offset="100%" stop-color="currentColor" stop-opacity="0.18" />
                                        </linearGradient>
                                    </defs>
                                    <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                                        <path
                                            d="M6 12.6c1.5-2 4.8-3 8.2-1.8L16 12.8l1.8-2c3.4-1.2 6.7-0.2 8.2 1.8v11.7c-1.5-2-4.8-3-8.2-1.8L16 24.9l-1.8-2.4c-3.4-1.2-6.7-0.2-8.2 1.8V12.6z"
                                            stroke-width="2.2" fill="url(#learnAurora)" />
                                        <path d="M16 13v11.9" stroke-width="2.2" />
                                        <path d="M13 21.6l-3 2m9-2l3 2" stroke-width="1.1" opacity="0.5" />
                                        <path d="M16 5.9l1.1 1.5L16 7.8l-1.1-0.4z" fill="currentColor" />
                                        <path
                                            d="M16 6.9l0.5 1.3 1.3 0.3-1.1 0.8 0.1 1.3L16 9.8l-0.8 0.8 0.1-1.3-1.1-0.8 1.3-0.3z"
                                            fill="currentColor" opacity="0.9" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" data-i18n="config.languageCards.learnTitle">Learn Target Languages
                            </h2>
                            <span class="card-badge" id="learnBadge">0</span>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="learn"></button>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>
                                <span data-i18n="config.languageCards.learnLabel">Select Learn Mode Languages</span>
                                <span class="label-description"
                                    data-i18n="config.languageCards.learnDescription">Creates "Learn (Language)" entries
                                    that pair source + translated
                                    lines in WebVTT. Select target "Learn" languages above after enabling.</span>
                            </label>

                            <div class="language-search">
                                <span class="language-search-icon">üîç</span>
                                <input type="text" id="learnSearch" data-i18n="config.languageCards.search"
                                    data-i18n-attr="placeholder" placeholder="Search languages...">
                            </div>

                            <div id="selectedLearnLanguages" class="selected-languages empty"></div>
                            <div class="field-error" id="learnLanguagesError"
                                data-i18n="config.validation.learnRequired">Please select at least one learn language
                            </div>

                            <div class="quick-actions">
                                <button type="button" class="quick-btn" data-action="select-popular-learn">
                                    <span aria-hidden="true">‚≠ê</span>
                                    <span data-i18n="config.languageCards.quickPopular">Popular</span>
                                </button>
                                <button type="button" class="quick-btn" data-action="select-all-learn">
                                    <span aria-hidden="true">‚úì</span>
                                    <span data-i18n="config.languageCards.quickAll">All</span>
                                </button>
                                <button type="button" class="quick-btn" data-action="clear-learn">
                                    <span aria-hidden="true">‚úó</span>
                                    <span data-i18n="config.languageCards.quickClear">Clear</span>
                                </button>
                            </div>

                            <div id="learnLanguages" class="language-grid"></div>
                        </div>
                    </div>
                </div>

                <div class="section-footer">
                    <button type="button" class="section-close-link collapsed" data-section-close="languages">
                        <span class="section-close-icon" aria-hidden="true">√ó</span>
                        <span data-i18n="config.sections.closeLink">Close section</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settingsSection" class="section-block collapsed">
            <div class="section-header">
                <div class="section-header-left">
                    <div class="section-icon section-emoji settings-emoji" aria-hidden="true">&#9881;</div>
                    <div>
                        <h2 class="section-title" id="settingsSectionTitle" data-i18n="config.sections.settingsTitle">
                            Settings</h2>
                        <p class="section-description" id="settingsSectionDescription"
                            data-i18n="config.sections.settingsDescription">Adjust translation behavior and other
                            preferences.</p>
                    </div>
                </div>
                <button type="button" class="collapse-btn section-collapse-btn collapsed"
                    data-collapse-section="settings"></button>
            </div>
            <div class="section-grid">

                <!-- Translation Settings -->
                <div class="card collapsed" data-card="translation" id="translationSettingsCard">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <defs>
                                        <linearGradient id="translationBubbles" x1="0%" y1="0%" x2="0%" y2="100%">
                                            <stop offset="0%" stop-color="currentColor" stop-opacity="0.12" />
                                            <stop offset="100%" stop-color="currentColor" stop-opacity="0.04" />
                                        </linearGradient>
                                    </defs>
                                    <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                        stroke-opacity="0.95">
                                        <!-- Left speech bubble -->
                                        <path
                                            d="M6.8 7.2h9.4a1.8 1.8 0 0 1 1.8 1.8v5.5a1.8 1.8 0 0 1-1.8 1.8h-4.4L9 19v-2.7H6.8a1.8 1.8 0 0 1-1.8-1.8V9a1.8 1.8 0 0 1 1.8-1.8Z"
                                            stroke-width="1.9" fill="url(#translationBubbles)" />
                                        <path d="M9.6 10.6h4.2M9.6 12.8h3.4M9.6 15h2.4" stroke-width="1.2" />

                                        <!-- Right speech bubble -->
                                        <path
                                            d="M15.2 15.2h9.2a1.8 1.8 0 0 1 1.8 1.8v5.5a1.8 1.8 0 0 1-1.8 1.8H20l-3 2.7v-2.7h-1.8a1.8 1.8 0 0 1-1.8-1.8V17a1.8 1.8 0 0 1 1.8-1.8Z"
                                            stroke-width="1.9" fill="url(#translationBubbles)" />
                                        <path d="M17.8 18.3h4.4M17.8 20.5h3.6" stroke-width="1.2" />

                                        <!-- Swap arrows -->
                                        <path d="M13.2 8c2.3-1.7 6.3-1.3 8.5.6" stroke-width="1.35" />
                                        <path d="M21 7.6l2.6 1.9-3 .6" stroke-width="1.35" />
                                        <path d="M18.8 23.3c-2.3 1.7-6.3 1.3-8.5-.6" stroke-width="1.35" />
                                        <path d="M11 23.7l-2.6-1.9 3-.6" stroke-width="1.35" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" data-i18n="config.translationSettings.title">Translation Settings
                            </h2>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="translation"></button>
                    </div>
                    <div class="card-content">
                        <div class="form-group" id="mainProviderGroup" style="margin-bottom: 1rem;">
                            <label for="mainProviderSelect">
                                <span data-i18n="config.providersUi.main.label">Main Provider</span>
                                <span class="label-description" data-i18n="config.providersUi.main.description">Choose
                                    which enabled AI provider to use when multiple are
                                    configured.</span>
                            </label>
                            <select id="mainProviderSelect">
                                <option value="gemini" data-i18n="config.providersUi.main.defaultGemini">Gemini</option>
                            </select>
                        </div>

                        <div class="form-group" id="secondaryProviderGroup" style="margin-bottom: 1.25rem;">
                            <label style="display: flex; align-items: flex-start; gap: 0.5rem;">
                                <input type="checkbox" id="enableSecondaryProvider" style="margin-top: 0.3rem;">
                                <div data-i18n="config.providersUi.secondary.label" data-i18n-attr="innerHTML">
                                    Secondary Provider
                                    <span class="label-description">If the main provider errors
                                        (429/503/prohibited/other),
                                        retry the failed batch with this provider, then continue with the main
                                        provider.</span>
                                </div>
                            </label>
                            <div id="secondaryProviderSelectRow" style="margin-top: 0.5rem; display: none;">
                                <select id="secondaryProviderSelect" disabled aria-label="Secondary provider selection">
                                    <option value="" data-i18n="config.providersUi.selectProvider">Select provider
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="sendTimestampsToAI" class="form-label">
                                <span class="label-title"
                                    data-i18n="config.translationSettings.workflow.label">Translation Workflow</span>
                                <div style="display: flex; align-items: center; gap: 0.35rem; flex-wrap: wrap;">
                                    <span class="label-description"
                                        data-i18n="config.translationSettings.workflow.description">Switching between
                                        modes is recommended if you have translation sync problems.</span>
                                    <div class="v3-warning-tooltip">
                                        <span class="warning-icon" tabindex="0"
                                            aria-label="Translation workflow details"
                                            data-i18n="config.translationSettings.workflow.tooltip"
                                            data-i18n-attr="aria-label">?</span>
                                        <div class="tooltip-bubble" role="tooltip" aria-hidden="true"
                                            id="translationWorkflowTooltip"
                                            data-i18n="config.translationSettings.workflow.tooltip">
                                            "Original Timestamps" mode removes timestamps and sends a numbered list of
                                            subtitle entries to the AI, then reconstructs the SRT with the original
                                            timestamps. "Send Timestamps to AI" sends the subtitles WITH timecodes and
                                            trusts the AI to return correct timestamps. Added for future-proofing the
                                            addon.
                                        </div>
                                    </div>
                                </div>
                            </label>
                            <select id="sendTimestampsToAI" class="styled-select">
                                <option value="original" data-i18n="config.translationSettings.workflow.original">
                                    Original Timestamps (Default)</option>
                                <option value="ai" data-i18n="config.translationSettings.workflow.ai">Send Timestamps to
                                    AI</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="databaseMode" class="form-label">
                                <span class="label-title" data-i18n="config.translationSettings.database.label">SubMaker
                                    Database</span>
                                <span class="label-description"
                                    data-i18n="config.translationSettings.database.description">SubMaker's database
                                    caches translations permanently to reduce community AI API costs/usage.<br>Bypass
                                    mode skips the shared database and stores translations temporarily (12
                                    hours).</span>
                            </label>
                            <select id="databaseMode" class="styled-select">
                                <option value="use" data-i18n="config.translationSettings.database.use">Use SubMaker
                                    Database</option>
                                <option value="bypass" data-i18n="config.translationSettings.database.bypass">Bypass
                                    Cache (Force Retranslation)</option>
                            </select>
                            <div id="databaseModeNote"
                                style="display: none; margin-top: 0.5rem; padding: 0.75rem; background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 8px; font-size: 0.875rem; color: var(--text-secondary);">
                                <strong style="color: var(--warning);"
                                    data-i18n="config.translationSettings.database.noteTitle">‚ö†Ô∏è Bypass Mode
                                    Required:</strong> <span id="databaseModeReason"></span>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="form-group" id="excludeHearingImpairedNoTranslationGroup" style="display: none;">
                    <label>
                        <input type="checkbox" id="excludeHearingImpairedSubtitlesNoTranslation">
                        <span data-i18n="config.otherSettings.excludeHearingImpaired.label">Hide SDH/HI subtitles</span>
                        <span class="label-description"
                            data-i18n="config.otherSettings.excludeHearingImpaired.description">Exclude subtitles
                            labeled "Subtitles for hearing impaired" (SDH/HI) from results.</span>
                    </label>
                </div>

                <div class="form-group" id="subToolboxNoTranslationGroup" style="display: none;">
                    <label>
                        <input type="checkbox" id="subToolboxEnabledNoTranslation">
                        <span data-i18n="config.otherSettings.subToolbox.label">Enable "Sub Toolbox" (Beta)</span>
                        <span class="label-description" id="subToolboxDescriptionNoTranslation"><span
                                data-i18n="config.otherSettings.subToolbox.description">Shows the Sub Toolbox entry in
                                Stremio subtitles for brower access to all tools.</span><span
                                id="subToolboxInstructionsWrapperNoTranslation" class="subtoolbox-instructions">(<a
                                    id="subToolboxInstructionsLinkNoTranslation" class="link-button subtle-link"
                                    href="#" style="font-size: 0.9rem;"><span
                                        data-i18n="config.otherSettings.subToolbox.instructionsLink">Read
                                        instructions</span></a>)</span></span>
                        <span class="label-description subtoolbox-tools-note"
                            data-i18n="config.otherSettings.subToolbox.tools">Tools: SRT Files Translation, Embedded
                            Subs Extraction, AutoSync and AutoSubbing.</span>
                    </label>
                </div>

                <!-- Other Settings -->
                <div class="card collapsed" data-card="cache" id="otherSettingsCard">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <g fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M6 9h8M18 9h8" />
                                        <circle cx="15" cy="9" r="2" fill="currentColor" />
                                        <path d="M6 16h8M18 16h8" />
                                        <circle cx="15" cy="16" r="2" fill="currentColor" />
                                        <path d="M6 23h4M14 23h12" />
                                        <circle cx="11" cy="23" r="2" fill="currentColor" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" data-i18n="config.otherSettings.title">Other Settings</h2>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="cache"></button>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="subToolboxEnabled">
                                <span data-i18n="config.otherSettings.subToolbox.label">Enable "Sub Toolbox"
                                    (Beta)</span>
                                <span class="label-description" id="subToolboxDescription"><span
                                        data-i18n="config.otherSettings.subToolbox.description">Shows the Sub Toolbox
                                        entry in Stremio subtitles for brower access to all tools.</span><span
                                        id="subToolboxInstructionsWrapper" class="subtoolbox-instructions">(<a
                                            id="subToolboxInstructionsLink" class="link-button subtle-link" href="#"
                                            style="font-size: 0.9rem;"><span
                                                data-i18n="config.otherSettings.subToolbox.instructionsLink">Read
                                                instructions</span></a>)</span></span>
                                <span class="label-description subtoolbox-tools-note"
                                    data-i18n="config.otherSettings.subToolbox.tools">Tools: SRT Files Translation,
                                    Embedded Subs Extraction, AutoSync and AutoSubbing.</span>
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="learnModeEnabled">
                                <span id="learnModeLabel" data-i18n="config.learnMode.label">Learn Mode</span>
                                <span class="label-description" id="learnModeDescription"
                                    data-i18n="config.learnMode.description">Adds "Learn (Language)" entries that output
                                    dual-language WebVTT
                                    with source and translated lines for language learning. After enabling, set Target
                                    Learn Languages in the "Languages" section above.</span>
                            </label>
                        </div>

                        <div class="form-group" id="learnOrderGroup" style="display: none;">
                            <label>
                                <span id="learnOrderLabel" data-i18n="config.learnMode.orderLabel">Learn Mode Subtitle
                                    Order</span>
                                <span class="label-description" id="learnOrderDescription"
                                    data-i18n="config.learnMode.orderDescription">Choose which language appears at the
                                    top and bottom of the
                                    screen.</span>
                            </label>
                            <div class="option-group" style="display: flex; gap: 0.75rem; margin-top: 0.35rem;">
                                <label
                                    style="background: white; padding: 0.5rem 0.75rem; border: 1px solid var(--border); border-radius: 8px; cursor: pointer;">
                                    <input type="radio" name="learnOrder" value="source-top" checked>
                                    <span data-i18n="config.learnMode.sourceTop">Source Top - Target Bottom</span>
                                </label>
                                <label
                                    style="background: white; padding: 0.5rem 0.75rem; border: 1px solid var(--border); border-radius: 8px; cursor: pointer;">
                                    <input type="radio" name="learnOrder" value="target-top">
                                    <span data-i18n="config.learnMode.targetTop">Target Top - Source Bottom</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="mobileMode">
                                <span data-i18n="config.otherSettings.mobileMode.label">Mobile Mode
                                    (fix/workaround)</span>
                                <span class="label-description"
                                    data-i18n="config.otherSettings.mobileMode.description">Stremio makes only 1 request
                                    for subtitles and caches it, so
                                    subtitles in Android can't be partially delivered. Mobile Mode holds translation
                                    requests
                                    and sends the final subtitle only when ready. Use this if you're watching on
                                    Android/iOS. No
                                    partial translations, no loading messages. Might freeze the stream until translation
                                    is
                                    ready. Flash-lite recommended. Wait 1-3 min, if it doesn't load automatically switch
                                    subtitles back and forth to load the translation.</span>
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="excludeHearingImpairedSubtitles">
                                <span data-i18n="config.otherSettings.excludeHearingImpaired.label">Hide SDH/HI
                                    subtitles</span>
                                <span class="label-description"
                                    data-i18n="config.otherSettings.excludeHearingImpaired.description">Exclude
                                    subtitles labeled "Subtitles for hearing impaired" (SDH/HI) from results.</span>
                            </label>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="betaMode">
                                <span data-i18n="config.otherSettings.betaMode.label">Advanced Mode</span>
                                <span class="label-description"
                                    data-i18n="config.otherSettings.betaMode.description">Unlocks Advanced Parameters
                                    Settings for Gemini and other
                                    providers.</span>
                            </label>
                        </div>

                        <div class="form-group" id="devModeGroup" style="display: none;">
                            <label>
                                <input type="checkbox" id="devMode">
                                <span data-i18n="config.otherSettings.devMode.label">Dev Mode</span>
                            </label>
                        </div>

                    </div>
                </div>

                <!-- Advanced Settings -->
                <div class="card collapsed" data-card="advanced" id="advancedSettingsCard" style="display: none;">
                    <div class="card-header">
                        <div class="card-title-group">
                            <div class="card-icon" aria-hidden="true">
                                <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                                    <defs>
                                        <linearGradient id="advCore" x1="30%" y1="0%" x2="70%" y2="100%">
                                            <stop offset="0%" stop-color="currentColor" stop-opacity="0.18" />
                                            <stop offset="100%" stop-color="currentColor" stop-opacity="0.05" />
                                        </linearGradient>
                                    </defs>
                                    <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="16" cy="16" r="10.5" stroke-width="2.2" />
                                        <path
                                            d="M16 4.5v2.5M16 25v2.5M7 9.5l2.2 1.3M22.8 21.2l2.2 1.3M7 22.5l2.2-1.3M22.8 10.8l2.2-1.3M4.5 16h2.6M24.9 16h2.6"
                                            stroke-width="1.4" />
                                        <path
                                            d="M16 7.2c2.3 1.7 3.8 4.6 3.1 7.8L16 27l-3.1-12c-0.7-3.2 0.8-6.1 3.1-7.8z"
                                            stroke-width="1.7" fill="url(#advCore)" />
                                        <path d="M13.3 15.6c-1.6 0.5-3 1.6-3 3.2 0 1 0.4 1.9 1.2 2.5"
                                            stroke-width="1.2" />
                                        <path d="M18.7 15.6c1.6 0.5 3 1.6 3 3.2 0 1-0.4 1.9-1.2 2.5"
                                            stroke-width="1.2" />
                                        <circle cx="16" cy="13.5" r="1.8" stroke-width="1.5" fill="currentColor" />
                                        <path d="M16 21.2l-2 2.5 2 1.4 2-1.4z" stroke-width="1.3" />
                                        <path d="M12 10.2c1-1.2 2.5-2.1 4-2.2" stroke-width="1.2" opacity="0.6" />
                                        <path d="M20 10.2c-1-1.2-2.5-2.1-4-2.2" stroke-width="1.2" opacity="0.6" />
                                    </g>
                                </svg>
                            </div>
                            <h2 class="card-title" data-i18n="config.advancedGemini.title">Advanced Settings</h2>
                        </div>
                        <button type="button" class="collapse-btn collapsed" data-collapse="advanced"></button>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="enableBatchContext">
                                <span data-i18n="config.advancedGemini.batchContext.label">Enable Batch Context</span>
                                <span class="label-description"
                                    data-i18n="config.advancedGemini.batchContext.description">Include original
                                    surrounding context and previous translations
                                    when processing batches. Improves translation coherence but may break outputs and
                                    increases
                                    token usage.</span>
                            </label>
                        </div>

                        <div class="form-group" id="contextSizeGroup" style="display: none;">
                            <label for="contextSize">
                                <span data-i18n="config.advancedGemini.contextSize.label">Context Size</span>
                                <span class="label-description"
                                    data-i18n="config.advancedGemini.contextSize.description">Number of surrounding
                                    entries to include as context (1-10).
                                    Default: 3</span>
                            </label>
                            <input type="number" id="contextSize" min="1" max="10" step="1" value="3" placeholder="3">
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="singleBatchMode">
                                <span data-i18n="config.translationSettings.chunking.label">Enable Single Batch</span>
                                <span class="label-description"
                                    data-i18n="config.translationSettings.chunking.description">Translate the whole
                                    subtitle in one go (still auto-splits at very large sizes). Improves contextual
                                    coherence but can hit provider limits more easily.</span>
                            </label>
                        </div>

                    </div>
                </div>

                <div class="section-footer">
                    <button type="button" class="section-close-link collapsed" data-section-close="settings">
                        <span class="section-close-icon" aria-hidden="true">√ó</span>
                        <span data-i18n="config.sections.closeLink">Close section</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Gemini Advanced Parameters -->
        <div class="card collapsed" id="geminiAdvancedCard" data-card="gemini-advanced" style="display: none;">
            <div class="card-header">
                <div class="card-title-group">
                    <div class="card-icon" aria-hidden="true">
                        <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                            <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="16" cy="16" r="10.5" stroke-width="2.2" />
                                <path d="M10 12c1.3-2 3.2-3 6-3s4.7 1 6 3" stroke-width="1.6" />
                                <path d="M10 20c1.3 2 3.2 3 6 3s4.7-1 6-3" stroke-width="1.6" />
                                <circle cx="16" cy="16" r="2.2" stroke-width="1.6" />
                            </g>
                        </svg>
                    </div>
                    <h2 class="card-title" data-i18n="config.advancedGemini.cardTitle">Gemini Advanced Parameters</h2>
                </div>
                <button type="button" class="collapse-btn collapsed" data-collapse="gemini-advanced"></button>
            </div>
            <div class="card-content">
                <div class="info-box" style="margin-bottom: 0.75rem;">
                    <p style="font-size: 0.95rem; margin: 0;">
                        <strong data-i18n="config.advancedGemini.infoTitle">Fine-tune Gemini behavior:</strong> <span
                            data-i18n="config.advancedGemini.infoBody">Override default Gemini model and sampling
                            parameters.</span>
                    </p>
                </div>
                <div class="highlight-box" style="margin-bottom: 1.25rem;">
                    <p style="font-size: 0.9rem; margin: 0;">
                        <span data-i18n="config.advancedGemini.cacheNotePrefix">When any Gemini setting is changed from
                            defaults,</span> <strong style="color: var(--warning);"
                            data-i18n="config.advancedGemini.cacheNoteStrong">Bypass
                            Cache is automatically enabled</strong> <span
                            data-i18n="config.advancedGemini.cacheNoteSuffix">to ensure your experimental translations
                            don't
                            pollute the shared database.</span>
                    </p>
                </div>

                <div class="form-group">
                    <label for="advancedModel">
                        <span data-i18n="config.advancedGemini.model.label">Translation Model Override</span>
                        <span class="label-description" data-i18n="config.advancedGemini.model.description">Override the
                            default model. Leave empty to use system default
                            (gemini-flash-latest).</span>
                    </label>
                    <select id="advancedModel">
                        <option value="" data-i18n="config.advancedGemini.model.default">Use Default Model</option>
                    </select>
                    <div class="model-status" id="modelStatus"></div>
                </div>

                <div class="form-group">
                    <label for="advancedThinkingBudget">
                        <span data-i18n="config.advancedGemini.thinking.label">Thinking Budget (Extended
                            Reasoning)</span>
                        <span class="label-description" data-i18n="config.advancedGemini.thinking.description">0 =
                            disabled, -1 = dynamic (auto-adjust), or fixed token count
                            (1-32768). Higher values = deeper reasoning but slower.</span>
                    </label>
                    <input type="number" id="advancedThinkingBudget" min="-1" max="32768" step="1" value="0"
                        placeholder="0">
                </div>

                <div class="form-group">
                    <label for="advancedTemperature">
                        <span data-i18n="config.advancedGemini.temperature.label">Temperature (Creativity)</span>
                        <span class="label-description"
                            data-i18n="config.advancedGemini.temperature.description">Controls randomness (0.0-2.0).
                            Lower = more deterministic,
                            Higher = more creative. Default: 0.8</span>
                    </label>
                    <input type="number" id="advancedTemperature" min="0" max="2" step="0.1" value="0.8"
                        placeholder="0.8">
                </div>

                <div class="form-group" style="margin-bottom: 0;">
                    <label for="advancedTopP">
                        <span data-i18n="config.advancedGemini.topP.label">Top-P (Nucleus Sampling)</span>
                        <span class="label-description" data-i18n="config.advancedGemini.topP.description">Probability
                            threshold (0.0-1.0). Lower = more focused, Higher =
                            more diverse. Default: 0.95</span>
                    </label>
                    <input type="number" id="advancedTopP" min="0" max="1" step="0.05" value="0.95" placeholder="0.95">
                </div>
            </div>
        </div>

        <!-- Other Advanced Parameters -->
        <div class="card collapsed" id="providerAdvancedCard" data-card="provider-advanced" style="display: none;">
            <div class="card-header">
                <div class="card-title-group">
                    <div class="card-icon" aria-hidden="true">
                        <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                            <g fill="none" stroke="currentColor" stroke-width="2.1" stroke-linecap="round"
                                stroke-linejoin="round">
                                <circle cx="16" cy="16" r="10.5" />
                                <path d="M16 5v4M16 23v4M5 16h4M23 16h4" />
                                <path d="M11 21l10-10M21 21 11 11" opacity="0.75" />
                            </g>
                        </svg>
                    </div>
                    <h2 class="card-title" data-i18n="config.providerAdvanced.title">Other Advanced Parameters</h2>
                </div>
                <button type="button" class="collapse-btn collapsed" data-collapse="provider-advanced"></button>
            </div>
            <div class="card-content">
                <div class="info-box" style="margin-bottom: 0.5rem;">
                    <p style="margin: 0;" data-i18n="config.providerAdvanced.intro">Fine-tune generation settings for
                        every enabled provider. These apply in
                        multi-provider mode only.</p>
                </div>

                <div id="providerAdvancedEmpty" class="highlight-box" style="display: none; margin-bottom: 0.75rem;">
                    <p style="margin: 0;" data-i18n="config.providerAdvanced.empty">Enable a provider above to unlock
                        its parameters.</p>
                </div>

                <div id="providerAdvancedContainer" style="display: flex; flex-direction: column; gap: 1rem;">
                    <div class="provider-advanced-block" data-provider="openai"
                        style="display: none; padding: 0.75rem 0.85rem; border: 1px solid var(--border); border-radius: 10px; background: var(--surface-light);">
                        <div
                            style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem; margin-bottom: 0.5rem;">
                            <strong data-i18n="config.providerAdvanced.providers.openai.title">OpenAI
                                Parameters</strong>
                            <span class="label-description"
                                data-i18n="config.providerAdvanced.providers.openai.description">Applies to OpenAI and
                                compatible endpoints</span>
                        </div>
                        <div
                            style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem;">
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openai-temperature"
                                    data-i18n="config.providerAdvanced.labels.temperature">Temperature</label>
                                <input type="number" id="provider-openai-temperature" min="0" max="2" step="0.05"
                                    value="0.4">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openai-reasoning"
                                    data-i18n="config.providerAdvanced.labels.reasoning">Reasoning effort</label>
                                <select id="provider-openai-reasoning">
                                    <option value="" data-i18n="config.providerAdvanced.reasoningDefaults.none">None
                                        (default - for non-reasoning models)</option>
                                    <option value="low" data-i18n="config.providerAdvanced.reasoningDefaults.low">Low
                                        (faster)</option>
                                    <option value="medium" selected
                                        data-i18n="config.providerAdvanced.reasoningDefaults.medium">Medium (balanced)
                                    </option>
                                    <option value="high" data-i18n="config.providerAdvanced.reasoningDefaults.high">High
                                        (deeper reasoning)</option>
                                </select>
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openai-topP"
                                    data-i18n="config.providerAdvanced.labels.topP">Top-P</label>
                                <input type="number" id="provider-openai-topP" min="0" max="1" step="0.01" value="0.95">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openai-maxTokens"
                                    data-i18n="config.providerAdvanced.labels.maxTokens">Max output tokens</label>
                                <input type="number" id="provider-openai-maxTokens" min="1" max="200000" step="1"
                                    value="32768">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openai-timeout"
                                    data-i18n="config.providerAdvanced.labels.timeout">Request timeout (s)</label>
                                <input type="number" id="provider-openai-timeout" min="5" max="600" step="5" value="60">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openai-retries"
                                    data-i18n="config.providerAdvanced.labels.retries">Max retries</label>
                                <input type="number" id="provider-openai-retries" min="0" max="5" step="1" value="2">
                            </div>
                        </div>
                    </div>

                    <div class="provider-advanced-block" data-provider="anthropic"
                        style="display: none; padding: 0.75rem 0.85rem; border: 1px solid var(--border); border-radius: 10px; background: var(--surface-light);">
                        <div
                            style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem; margin-bottom: 0.5rem;">
                            <strong data-i18n="config.providerAdvanced.providers.anthropic.title">Anthropic
                                Parameters</strong>
                            <span class="label-description"
                                data-i18n="config.providerAdvanced.providers.anthropic.description">Claude / Anthropic
                                API tuning</span>
                        </div>
                        <div
                            style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem;">
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-anthropic-temperature"
                                    data-i18n="config.providerAdvanced.labels.temperature">Temperature</label>
                                <input type="number" id="provider-anthropic-temperature" min="0" max="2" step="0.05"
                                    value="0.4">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-anthropic-topP"
                                    data-i18n="config.providerAdvanced.labels.topP">Top-P</label>
                                <input type="number" id="provider-anthropic-topP" min="0" max="1" step="0.01"
                                    value="0.95">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-anthropic-maxTokens"
                                    data-i18n="config.providerAdvanced.labels.maxTokens">Max output tokens</label>
                                <input type="number" id="provider-anthropic-maxTokens" min="1" max="200000" step="1"
                                    value="32768">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-anthropic-timeout"
                                    data-i18n="config.providerAdvanced.labels.timeout">Request timeout (s)</label>
                                <input type="number" id="provider-anthropic-timeout" min="5" max="600" step="5"
                                    value="60">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-anthropic-retries"
                                    data-i18n="config.providerAdvanced.labels.retries">Max retries</label>
                                <input type="number" id="provider-anthropic-retries" min="0" max="5" step="1" value="2">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-anthropic-thinking"
                                    data-i18n="config.providerAdvanced.labels.thinking">Thinking budget (tokens)</label>
                                <input type="number" id="provider-anthropic-thinking" min="0" max="200000" step="256"
                                    value="0">
                            </div>
                        </div>
                    </div>

                    <div class="provider-advanced-block" data-provider="xai"
                        style="display: none; padding: 0.75rem 0.85rem; border: 1px solid var(--border); border-radius: 10px; background: var(--surface-light);">
                        <div
                            style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem; margin-bottom: 0.5rem;">
                            <strong data-i18n="config.providerAdvanced.providers.xai.title">XAI (Grok)
                                Parameters</strong>
                            <span class="label-description"
                                data-i18n="config.providerAdvanced.providers.xai.description">Grok API tuning</span>
                        </div>
                        <div
                            style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem;">
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-xai-temperature"
                                    data-i18n="config.providerAdvanced.labels.temperature">Temperature</label>
                                <input type="number" id="provider-xai-temperature" min="0" max="2" step="0.05"
                                    value="0.4">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-xai-topP"
                                    data-i18n="config.providerAdvanced.labels.topP">Top-P</label>
                                <input type="number" id="provider-xai-topP" min="0" max="1" step="0.01" value="0.95">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-xai-maxTokens"
                                    data-i18n="config.providerAdvanced.labels.maxTokens">Max output tokens</label>
                                <input type="number" id="provider-xai-maxTokens" min="1" max="200000" step="1"
                                    value="32768">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-xai-timeout"
                                    data-i18n="config.providerAdvanced.labels.timeout">Request timeout (s)</label>
                                <input type="number" id="provider-xai-timeout" min="5" max="600" step="5" value="60">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-xai-retries" data-i18n="config.providerAdvanced.labels.retries">Max
                                    retries</label>
                                <input type="number" id="provider-xai-retries" min="0" max="5" step="1" value="2">
                            </div>
                        </div>
                    </div>

                    <div class="provider-advanced-block" data-provider="deepseek"
                        style="display: none; padding: 0.75rem 0.85rem; border: 1px solid var(--border); border-radius: 10px; background: var(--surface-light);">
                        <div
                            style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem; margin-bottom: 0.5rem;">
                            <strong data-i18n="config.providerAdvanced.providers.deepseek.title">DeepSeek
                                Parameters</strong>
                            <span class="label-description"
                                data-i18n="config.providerAdvanced.providers.deepseek.description">DeepSeek chat
                                endpoints</span>
                        </div>
                        <div
                            style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem;">
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepseek-temperature"
                                    data-i18n="config.providerAdvanced.labels.temperature">Temperature</label>
                                <input type="number" id="provider-deepseek-temperature" min="0" max="2" step="0.05"
                                    value="0.4">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepseek-topP"
                                    data-i18n="config.providerAdvanced.labels.topP">Top-P</label>
                                <input type="number" id="provider-deepseek-topP" min="0" max="1" step="0.01"
                                    value="0.95">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepseek-maxTokens"
                                    data-i18n="config.providerAdvanced.labels.maxTokens">Max output tokens</label>
                                <input type="number" id="provider-deepseek-maxTokens" min="1" max="200000" step="1"
                                    value="32768">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepseek-timeout"
                                    data-i18n="config.providerAdvanced.labels.timeout">Request timeout (s)</label>
                                <input type="number" id="provider-deepseek-timeout" min="5" max="600" step="5"
                                    value="60">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepseek-retries"
                                    data-i18n="config.providerAdvanced.labels.retries">Max retries</label>
                                <input type="number" id="provider-deepseek-retries" min="0" max="5" step="1" value="2">
                            </div>
                        </div>
                    </div>

                    <div class="provider-advanced-block" data-provider="deepl"
                        style="display: none; padding: 0.75rem 0.85rem; border: 1px solid var(--border); border-radius: 10px; background: var(--surface-light);">
                        <div
                            style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem; margin-bottom: 0.5rem;">
                            <strong data-i18n="config.providerAdvanced.providers.deepl.title">DeepL Parameters</strong>
                            <span class="label-description"
                                data-i18n="config.providerAdvanced.providers.deepl.description">Formality & formatting
                                controls</span>
                        </div>
                        <div
                            style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem;">
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepl-formality"
                                    data-i18n="config.providerAdvanced.labels.formality">Formality</label>
                                <select id="provider-deepl-formality">
                                    <option value="default" data-i18n="config.providerAdvanced.formality.default">
                                        Default</option>
                                    <option value="more" data-i18n="config.providerAdvanced.formality.more">More formal
                                    </option>
                                    <option value="less" data-i18n="config.providerAdvanced.formality.less">Less formal
                                    </option>
                                </select>
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepl-timeout"
                                    data-i18n="config.providerAdvanced.labels.timeout">Request timeout (s)</label>
                                <input type="number" id="provider-deepl-timeout" min="5" max="600" step="5" value="60">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepl-retries"
                                    data-i18n="config.providerAdvanced.labels.retries">Max retries</label>
                                <input type="number" id="provider-deepl-retries" min="0" max="5" step="1" value="2">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-deepl-preserveFormatting"
                                    data-i18n="config.providerAdvanced.labels.preserveFormatting">Preserve
                                    formatting</label>
                                <label style="display:flex; align-items:center; gap:0.5rem; padding:0.35rem 0;">
                                    <input type="checkbox" id="provider-deepl-preserveFormatting" checked>
                                    <span class="label-description"
                                        data-i18n="config.providerAdvanced.labels.preserveFormattingHint"
                                        style="margin:0;">Keep line breaks, casing, and tags
                                        intact</span>
                                </label>
                            </div>
                        </div>
                        <div class="label-description" data-i18n="config.providerAdvanced.providers.deepl.footer"
                            style="margin-top:0.35rem;">Beta languages auto-enable
                            quality_optimized and disable latency_optimized.</div>
                    </div>

                    <div class="provider-advanced-block" data-provider="mistral"
                        style="display: none; padding: 0.75rem 0.85rem; border: 1px solid var(--border); border-radius: 10px; background: var(--surface-light);">
                        <div
                            style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem; margin-bottom: 0.5rem;">
                            <strong data-i18n="config.providerAdvanced.providers.mistral.title">Mistral
                                Parameters</strong>
                            <span class="label-description"
                                data-i18n="config.providerAdvanced.providers.mistral.description">Mistral API
                                tuning</span>
                        </div>
                        <div
                            style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem;">
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-mistral-temperature"
                                    data-i18n="config.providerAdvanced.labels.temperature">Temperature</label>
                                <input type="number" id="provider-mistral-temperature" min="0" max="2" step="0.05"
                                    value="0.4">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-mistral-topP"
                                    data-i18n="config.providerAdvanced.labels.topP">Top-P</label>
                                <input type="number" id="provider-mistral-topP" min="0" max="1" step="0.01"
                                    value="0.95">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-mistral-maxTokens"
                                    data-i18n="config.providerAdvanced.labels.maxTokens">Max output tokens</label>
                                <input type="number" id="provider-mistral-maxTokens" min="1" max="200000" step="1"
                                    value="32768">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-mistral-timeout"
                                    data-i18n="config.providerAdvanced.labels.timeout">Request timeout (s)</label>
                                <input type="number" id="provider-mistral-timeout" min="5" max="600" step="5"
                                    value="60">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-mistral-retries"
                                    data-i18n="config.providerAdvanced.labels.retries">Max retries</label>
                                <input type="number" id="provider-mistral-retries" min="0" max="5" step="1" value="2">
                            </div>
                        </div>
                    </div>

                    <div class="provider-advanced-block" data-provider="cfworkers"
                        style="display: none; padding: 0.75rem 0.85rem; border: 1px solid var(--border); border-radius: 10px; background: var(--surface-light);">
                        <div
                            style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem; margin-bottom: 0.5rem;">
                            <strong data-i18n="config.providerAdvanced.providers.cfworkers.title">Cloudflare Workers AI
                                Parameters</strong>
                            <span class="label-description"
                                data-i18n="config.providerAdvanced.providers.cfworkers.description">Use ACCOUNT_ID|TOKEN
                                format</span>
                        </div>
                        <div
                            style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem;">
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-cfworkers-temperature"
                                    data-i18n="config.providerAdvanced.labels.temperature">Temperature</label>
                                <input type="number" id="provider-cfworkers-temperature" min="0" max="2" step="0.05"
                                    value="0.4">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-cfworkers-topP"
                                    data-i18n="config.providerAdvanced.labels.topP">Top-P</label>
                                <input type="number" id="provider-cfworkers-topP" min="0" max="1" step="0.01"
                                    value="0.9">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-cfworkers-maxTokens"
                                    data-i18n="config.providerAdvanced.labels.maxTokens">Max output tokens</label>
                                <input type="number" id="provider-cfworkers-maxTokens" min="1" max="200000" step="1"
                                    value="32768">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-cfworkers-timeout"
                                    data-i18n="config.providerAdvanced.labels.timeout">Request timeout (s)</label>
                                <input type="number" id="provider-cfworkers-timeout" min="5" max="600" step="5"
                                    value="60">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-cfworkers-retries"
                                    data-i18n="config.providerAdvanced.labels.retries">Max retries</label>
                                <input type="number" id="provider-cfworkers-retries" min="0" max="5" step="1" value="2">
                            </div>
                        </div>
                    </div>

                    <div class="provider-advanced-block" data-provider="openrouter"
                        style="display: none; padding: 0.75rem 0.85rem; border: 1px solid var(--border); border-radius: 10px; background: var(--surface-light);">
                        <div
                            style="display:flex; align-items:center; justify-content: space-between; gap:0.75rem; margin-bottom: 0.5rem;">
                            <strong data-i18n="config.providerAdvanced.providers.openrouter.title">OpenRouter
                                Parameters</strong>
                            <span class="label-description"
                                data-i18n="config.providerAdvanced.providers.openrouter.description">OpenRouter
                                routing</span>
                        </div>
                        <div
                            style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem;">
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openrouter-temperature"
                                    data-i18n="config.providerAdvanced.labels.temperature">Temperature</label>
                                <input type="number" id="provider-openrouter-temperature" min="0" max="2" step="0.05"
                                    value="0.4">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openrouter-topP"
                                    data-i18n="config.providerAdvanced.labels.topP">Top-P</label>
                                <input type="number" id="provider-openrouter-topP" min="0" max="1" step="0.01"
                                    value="0.95">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openrouter-maxTokens"
                                    data-i18n="config.providerAdvanced.labels.maxTokens">Max output tokens</label>
                                <input type="number" id="provider-openrouter-maxTokens" min="1" max="200000" step="1"
                                    value="32768">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openrouter-timeout"
                                    data-i18n="config.providerAdvanced.labels.timeout">Request timeout (s)</label>
                                <input type="number" id="provider-openrouter-timeout" min="5" max="600" step="5"
                                    value="60">
                            </div>
                            <div style="display:flex; flex-direction:column; gap:0.25rem;">
                                <label for="provider-openrouter-retries"
                                    data-i18n="config.providerAdvanced.labels.retries">Max retries</label>
                                <input type="number" id="provider-openrouter-retries" min="0" max="5" step="1"
                                    value="2">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dev Settings (hidden until Ctrl+Alt+D) -->
        <div class="card collapsed" data-card="dev" id="devSettingsCard" style="display: none;">
            <div class="card-header">
                <div class="card-title-group">
                    <div class="card-icon" aria-hidden="true">
                        <svg viewBox="0 0 32 32" aria-hidden="true" focusable="false">
                            <g fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M12 6l-8 10 8 10M20 6l8 10-8 10" />
                                <path d="M19 4l-6 24" />
                            </g>
                        </svg>
                    </div>
                    <h2 class="card-title" data-i18n="config.dev.title">Dev</h2>
                </div>
                <button type="button" class="collapse-btn collapsed" data-collapse="dev"></button>
            </div>
            <div class="card-content">
            </div>
        </div>

        <!-- Actions -->
        <div class="btn-group">
            <button type="submit" class="btn btn-primary" accesskey="enter">
                <span aria-hidden="true">üíæ</span>
                <span data-i18n="config.actions.save">Save Configuration</span>
            </button>
            <button type="button" class="btn btn-secondary" id="installBtn" disabled>
                <span aria-hidden="true">üöÄ</span>
                <span data-i18n="config.actions.install">Install in Stremio</span>
            </button>
            <button type="button" class="btn btn-secondary" id="copyBtn" disabled>
                <span aria-hidden="true">üìã</span>
                <span data-i18n="config.actions.copy">Copy Install URL</span>
            </button>
        </div>

        <!-- Install URL Display -->
        <div class="install-url-box" id="installUrlBox">
            <label for="installUrlDisplay" data-i18n="config.actions.installLabel">Install URL</label>
            <input type="text" id="installUrlDisplay" readonly>
        </div>
    </form>

    <!-- Full Reset CTA (positioned vertically by JS) -->
    <div id="resetBarWrapper" class="reset-bar">
        <div class="reset-text" data-i18n="config.reset.hint">Any problems- Reset settings to default -></div>
        <button type="button" id="resetSettingsBtn" class="reset-btn" data-i18n="config.reset.cta">Reset</button>
    </div>
</div>